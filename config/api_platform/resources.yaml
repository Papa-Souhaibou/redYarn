resources:
  App\Entity\User:
      attributes:
        route_prefix: /admin
        normalization_context:
          groups: [ 'user_read' ]
      itemOperations:
        get_user:
          method: GET
          path: /users/{id}
          requirements:
            id: \d+
        set_user:
          method: PUT
          path: /users/{id}
          requirements:
            id: \d+
          controller: App\Controller\UserController::setUser
          deserialize: false
        delete_user:
          method: DELETE
          path: /users/{id}
          requirements:
            id: \d+

      collectionOperations:
        get_users:
          method: GET
          path: /users
        add_user:
          method: POST
          path: /users
          normalization_context:
            groups: [ 'user_read' ]
          controller: App\Controller\UserController::addUser
          deserialize: false

  App\Entity\Admin:
    attributes:
      normalization_context:
        groups: [ 'user_read' ]

  App\Entity\Apprenant:
    attributes:
      normalization_context:
        groups: [ 'user_read' ]
    collectionOperations:
      get_apprenants:
        method: GET
        path: /apprenants
      add_apprenant:
        method: POST
        path: /apprenants
        controller: App\Controller\ApprenantController::addStudent
        deserialize: false
    itemOperations:
      get_apprenant:
        method: GET
        path: /apprenants/{id}
        requirements:
          id: \d+
      set_apprenant:
        method: PUT
        path: /apprenants/{id}
        requirements:
          id: \d+
        controller: App\Controller\UserController::setUser

  App\Entity\Formateur:
    attributes:
      normalization_context:
        groups: [ 'user_read' ]
      collectionOperations:
        get_formateurs:
          method: GET
          path: /formateurs
        add_formateur:
          method: POST
          path: /formateurs
      itemOperations:
        get_formateur:
          method: GET
          path: /formateurs/{id}
          requirements:
            id: \d+
        set_formateur:
          method: PUT
          path: /formateurs/{id}
          requirements:
            id: \d+
          controller: App\Controller\UserController::setUser

  App\Entity\Profil:
    attributes:
      normalization_context:
        groups: ['profil_read']
      route_prefix: /admin
      security: is_granted('ROLE_ADMIN')
      security_message: Only admins have access to this resource.
    properties:
      users:
        subresource:
          resourceClass: App\Entity\User
          collection: false
    subresourceOperations:
      collectionOperations:
        attributes:
          normalization_context:
            groups: [ 'users_with_this_profil' ]
        get_users_with_this_profil:
          method: GET

    collectionOperations:
      get_profils:
        method: GET
        path: /profils
      add_profil:
        method: POST
        path: /profils

    itemOperations:
      get_profil:
        method: GET
        path: /profils/{id}
        requirements:
          id: \d+
      set_profil:
        method: PUT
        path: /profils/{id}
        requirements:
          id: \d+
      delete_profil:
        method: DELETE
        path: /profils/{id}
        requirements:
          id: \d+

  App\Entity\ProfilSortie:
      attributes:
        route_prefix: /admin
      properties:
        apprenants:
          requirements:
            id: \d
          subresource:
            path: /profilsorties/{id}/apprenants
            resourceClass: App\Entity\Apprenant
            collection: true
      collectionOperations:
        get_profilSorties:
          method: GET
          path: /profilsorties
        add_profilSortie:
          method: POST
          path: /profilsorties
      itemOperations:
        get_profilSortie:
          method: GET
          path: /profilsorties/{id}
          requirements:
            id: \d+
        set_profilSortie:
          method: PUT
          path: /profilsorties/{id}
          requirements:
            id: \d+

  App\Entity\GroupeCompetence:
    attributes:
      normalization_context:
        groups: [ 'grpecompetence_read' ]
      route_prefix: /admin
    properties:
      competences:
        subresource:
          resourceClass: App\Entity\Competence
          collection: false
    itemOperations:
      get_grpecompetence:
        method: GET
        path: /grpecompetences/{id}
        requirements:
          id: \d+
      set_grpecompetence:
        method: PUT
        path: /grpecompeteces/{id}
        requirements:
          id: \d+
      delete_grpecompetence:
        method: DELETE
        path: /grpecompetences/{id}
        requirements:
          id: \d+
    collectionOperations:
      get_grpecompetence:
        method: GET
        path: /grpecompetences
      add_grpecompetence:
        method: POST
        path: /grpecompetences
        controller: App\Controller\GroupeCompetenceController::addGrpeCompetence
        deserialize: false

  App\Entity\Competence:
    attributes:
      normalization_context:
        groups: ['competence_read']
      route_prefix: /admin
      #security: is_granted('ROLE_ADMIN')
      #security_message: Acces denied

    collectionOperations:
      get_competences:
        method: GET
        path: /competences
      add_competence:
        method: POST
        path: /competences
    itemOperations:
      get_competence:
        method: GET
        path: /competences/{id}
        requirements:
          id: \d+
      set_competence:
        method: PUT
        path: /competences/{id}
        requirements:
          id: \d+

  App\Entity\Referentiel:
    attributes:
      normalization_context:
        groups: ['referentiel_read']
      route_prefix: /admin
      security: is_granted('ROLE_ADMIN')
      security_message: Access Denied
    properties:
      groupeCompetences:
        subresource:
          resourceClass: App\Entity\GroupeCompetence
          collection: false
    collectionOperations:
      get_referentiels:
        method: GET
        path: /referentiels
      add_referentiel:
        method: POST
        path: /referentiels
    itemOperations:
      get_referentiel:
        method: GET
        path: /referentiels/{id}
        requirements:
          id: \d+
      get_grpcompetence_in_referentiel:
        method: GET
      set_referentiel:
        method: PUT
        path: /referentiels/{id}
        requirements:
          id: \d+
      delete_referentiel:
        method: DELETE
        path: /referentiels/{id}
        requirements:
          id: \d+